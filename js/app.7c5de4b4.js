(function(e){function n(n){for(var r,o,s=n[0],c=n[1],l=n[2],d=0,m=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(n);while(m.length)m.shift()();return i.push.apply(i,l||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],r=!0,s=1;s<t.length;s++){var c=t[s];0!==a[c]&&(r=!1)}r&&(i.splice(n--,1),e=o(o.s=t[0]))}return e}var r={},a={app:0},i=[];function o(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=r,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)o.d(t,r,function(n){return e[n]}.bind(null,r));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="/3d-to-spritesheet/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var l=0;l<s.length;l++)n(s[l]);var u=c;i.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"034f":function(e,n,t){"use strict";t("85ec")},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var r=t("2b0e"),a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"},on:{drop:function(n){return n.preventDefault(),e.droppedFiles.apply(null,arguments)},dragover:function(e){e.preventDefault()}}})},i=[],o=t("3835"),s=t("2909"),c=t("1da1"),l=t("668b"),u=(t("96cf"),t("b64b"),t("99af"),t("d3b7"),t("5cc6"),t("907a"),t("9a8c"),t("a975"),t("735e"),t("c1ac"),t("d139"),t("3a7b"),t("d5d6"),t("82f8"),t("e91f"),t("60bd"),t("5f96"),t("3280"),t("3fcc"),t("ca91"),t("25a1"),t("cd26"),t("3c5d"),t("2954"),t("649e"),t("219c"),t("170b"),t("b39a"),t("72f7"),t("159b"),t("07ac"),t("ac1f"),t("5319"),t("e9c4"),t("d81d"),t("b0c0"),t("4de4"),t("caad"),t("2532"),t("33d1"),t("ea98"),t("1276"),t("7db0"),t("3ca3"),t("ddb0"),t("2b3d"),t("9861"),t("4e82"),t("5a89")),d=t("4721"),m=t("8710"),f=t("d8dd"),h=t("9fe7"),p=t("ef20"),g=t("b9d8"),w=t("c4e3"),v=t.n(w),b=t("21a6"),x=t("bc3a"),F=t.n(x),R=t("a2d6");t("a630");function y(e){return A.apply(this,arguments)}function A(){return A=Object(c["a"])(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(n.dataTransfer.items&&n.dataTransfer.items.length&&n.dataTransfer.items[0].webkitGetAsEntry)){e.next=7;break}return t=Array.from(n.dataTransfer.items).map((function(e){return e.webkitGetAsEntry()})),e.next=4,k(t);case 4:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",Object(s["a"])(n.dataTransfer.files));case 8:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}function k(e){return S.apply(this,arguments)}function S(){return S=Object(c["a"])(regeneratorRuntime.mark((function e(n){var t,r,a,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=[],r=0;case 2:if(!(r<n.length)){e.next=36;break}if(a=n[r],a){e.next=6;break}return e.abrupt("continue",33);case 6:if(!a.isFile){e.next=14;break}return e.t0=t,e.next=10,P(a);case 10:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=33;break;case 14:if(!a.isDirectory){e.next=33;break}return i=a.createReader(),e.next=18,j(i);case 18:o=e.sent;case 19:if(!(o.length>0)){e.next=33;break}return e.t2=t.push,e.t3=t,e.t4=s["a"],e.next=25,k(o);case 25:return e.t5=e.sent,e.t6=(0,e.t4)(e.t5),e.t2.apply.call(e.t2,e.t3,e.t6),e.next=30,j(i);case 30:o=e.sent,e.next=19;break;case 33:r++,e.next=2;break;case 36:return e.abrupt("return",t);case 37:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function j(e){return z.apply(this,arguments)}function z(){return z=Object(c["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){n.readEntries(e,t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),z.apply(this,arguments)}function P(e){return O.apply(this,arguments)}function O(){return O=Object(c["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){n.file((function(n){return e(n)}),(function(e){return t(e)}))})));case 1:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}var _=t("5530");function M(e,n,t){var r=t.distance||1,a=Math.max(e.x,e.y,e.z)*r,i=C(90),o=C(t.viewAngle),s={position:T(.25*a,{x:e.x,y:1.6*e.y,z:e.z},i,0),target:[0,e.y/2*1.6,0],startAngle:270};return n&&n.icon&&n.icon.camera&&(s=Object(_["a"])(Object(_["a"])({},s),n.icon.camera)),{spritesheet:{position:T(a,e,i,o),target:[0,e.y/2,0]},icon:s}}function C(e){return"string"===typeof e&&(e=parseFloat(e)),isNaN(e)&&(e=90),e*Math.PI/180}function T(e,n,t,r){var a=-e*Math.cos(t)*Math.sin(r),i=n.y/2+e*Math.sin(r),o=e*Math.sin(t)*Math.cos(r);return[a,i,o]}var L=null,E=null,N=new Worker("pngquant/worker.js");function D(e){return U.apply(this,arguments)}function U(){return U=Object(c["a"])(regeneratorRuntime.mark((function e(n){var t,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.length>1&&void 0!==r[1]?r[1]:{},!L){e.next=4;break}return console.error("Trying to start a new job while something is still running"),e.abrupt("return");case 4:return e.abrupt("return",new Promise((function(e,r){N.postMessage({type:"command",arguments:t,file:{name:"input.png",data:n}}),L=e,E=r})));case 5:case"end":return e.stop()}}),e)}))),U.apply(this,arguments)}N.onmessage=function(e){var n=e.data;if("start"===n.type)console.log("worker started");else if("stdout"===n.type)console.log("Worker message: ".concat(n.data));else if("done"===n.type){var t=n.data;1===t.length&&t[0]instanceof Error?(console.error("Worker error: ".concat(t[0])),E(t[0]),L=null,E=null):(L(t[0].data),L=null,E=null)}};var W=256,H=16,B={data:function(){return{config:null,currentModel:null,directionalLight:null,modelReady:!1,renderer:null,camera:null,gui:null,scene:null,mixer:null,activeAction:null,animationActions:{},animationsFolder:null,modelFolder:null,actionsFolder:null,recordParams:{frames:4,frameSize:W,sheetSize:4096,distance:1,viewAngle:0,compressPNG:!0},angles:null,angleNames:null,anglesFolder:null,isRecording:!1,directoryHandle:null}},methods:{setAction:function(e){if(e!=this.activeAction){var n=this.activeAction;this.activeAction=e,n&&n.stop(),this.activeAction.play()}else e.reset()},recordAllAsSheets:function(e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r,a,i,o,s,c,l,u,d,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.angleNames,a=Object.keys(n.animationActions),i=n.recordParams.sheetSize/n.recordParams.frameSize,o=n.initRecordings(e),s=0;case 5:if(!(s<a.length)){t.next=20;break}if(c=a[s],l=n.animationActions[c].frames,u=i-1-o.row,d=u*i+(i-1-o.column),m=l*r.length,!(m>d)){t.next=15;break}return console.warn("skipping to next sheet since we need ".concat(m," slots with ").concat(d," left")),t.next=15,n.startNewSheet(o);case 15:return t.next=17,n.drawFramesFromAnimation(c,o);case 17:s++,t.next=5;break;case 20:return t.next=22,n.finishRecordings(o);case 22:if(!n.config.icon){t.next=31;break}return n.setRenderSize(n.config.icon.size),n.resetSheetCanvas(o),o.canvas.width=n.config.icon.size,o.canvas.height=n.config.icon.size,t.next=29,n.drawFramesFromAnimation("icon",o);case 29:return t.next=31,n.saveImageToZip(o,"icon.png");case 31:o.finishWriting();case 32:case"end":return t.stop()}}),t)})))()},recordAnimationAsSheet:function(e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=n.initRecordings(e),t.next=3,n.drawFramesFromAnimation(e,r);case 3:return t.next=5,n.finishRecordings(r);case 5:r.finishWriting();case 6:case"end":return t.stop()}}),t)})))()},initRecordings:function(e){var n=this,t=document.createElement("canvas");if("icon"===e)t.width=this.config.icon.size,t.height=this.config.icon.size,this.setRenderSize(this.config.icon.size);else{t.width=this.recordParams.sheetSize,t.height=this.recordParams.sheetSize;var r=this.config.frameSize||W;this.setRenderSize(r)}var a=t.getContext("2d"),i={canvas:t,ctx:a,row:0,column:0,sheet:0,json:{},modelName:e};if(this.directoryHandle)i.saveFile=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,r){var a,i,o,s,c,l,u,d=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=d.length>2&&void 0!==d[2]?d[2]:{},a.base64){if("string"===typeof r){for(o=window.atob(r),s=new Array(o.length),c=0;c<o.length;c++)s[c]=o.charCodeAt(c);i=new Uint8Array(s)}else i=r;r=new Blob([i],{type:"image/png"})}return e.next=4,n.directoryHandle.getFileHandle(t,{create:!0});case 4:return l=e.sent,e.next=7,l.createWritable();case 7:return u=e.sent,e.next=10,u.write(r);case 10:return e.next=12,u.close();case 12:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),i.finishWriting=function(){alert("done writing files")};else{var o=new v.a;i.saveFile=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(n,t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o.file(n,t,r);case 1:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),i.finishWriting=function(){o.generateAsync({type:"blob",streamFiles:!0}).then((function(n){Object(b["saveAs"])(n,"".concat(e,".zip"))}))}}return i},finishRecordings:function(e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.column>0||e.row>0)){t.next=5;break}return r="".concat(e.modelName).concat(e.sheet,".png"),0===e.sheet&&(r="".concat(e.modelName,".png"),Object.values(e.json).forEach((function(e){e.sheet=e.sheet.replace("0.png",".png")}))),t.next=5,n.saveImageToZip(e,r);case 5:return t.next=7,e.saveFile("animations.json",JSON.stringify(e.json,null,"\t"));case 7:case"end":return t.stop()}}),t)})))()},drawFramesFromAnimation:function(e,n){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var a,i,o,s,c,l,u,d,m,f,h,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("icon"!==e){r.next=8;break}return t.updateAngle("icon"),a=t.config.icon.animation,i=t.animationActions[a],o=i.action,s=i.frames,c=i.animationConfig,r.next=6,t.drawFramesFromAnimationAngle(n,o,s,e,"icon",c);case 6:r.next=19;break;case 8:l=t.angleNames,u=t.animationActions[e],d=u.action,m=u.frames,f=u.animationConfig,h=0;case 11:if(!(h<l.length)){r.next=19;break}return p=l[h],t.updateAngle(p),r.next=16,t.drawFramesFromAnimationAngle(n,d,m,e,p,f);case 16:h++,r.next=11;break;case 19:case"end":return r.stop()}}),r)})))()},drawFramesFromAnimationAngle:function(e,n,t,r,a,i){var o=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var c,l,u,d;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return o.setAction(n),c=o.getActionDuration(n,i),l=t||o.recordParams.frames,u=c/l,l<=1&&(u=0),o.isRecording=!0,o.mixer.update(0),s.next=9,I();case 9:d=0;case 10:if(!(d<l)){s.next=19;break}return s.next=13,o.drawFrameFromAnimation(e,r,a);case 13:return o.mixer.update(u),s.next=16,I();case 16:d++,s.next=10;break;case 19:o.isRecording=!1;case 20:case"end":return s.stop()}}),s)})))()},getActionDuration:function(e,n){var t=1;return n&&n.skipEnd&&(t=1-n.skipEnd),e._clip.duration*t},drawFrameFromAnimation:function(e,n,t){var r=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.ctx.drawImage(r.renderer.domElement,e.column*r.recordParams.frameSize,e.row*r.recordParams.frameSize),i=r.recordParams.sheetSize/r.recordParams.frameSize,e.json[n]||(e.json[n]={sheet:"".concat(e.modelName).concat(e.sheet,".png"),directions:{}}),e.json[n].directions[t]||(e.json[n].directions[t]=[]),e.json[n].directions[t].push(e.row*i+e.column),90!=t&&270!=t&&(o=null,o=t<90?180-t:360-t+180,e.json[n].directions[o]||(e.json[n].directions[o]=[]),e.json[n].directions[o].push(e.row*i+e.column)),e.column++,!(e.column>=i)){a.next=13;break}if(e.column=0,e.row++,!(e.row>=i)){a.next=13;break}return a.next=13,r.startNewSheet(e);case 13:case"end":return a.stop()}}),a)})))()},saveImageToZip:function(e,n){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var a,i,o,s,c,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.canvas.toDataURL("image/png").replace("data:image/png;base64,",""),i=a,!t.recordParams.compressPNG){r.next=21;break}for(t.isRecording=!0,o=window.atob(a),s=new Uint8Array(o.length),c=0;c<o.length;c++)s[c]=o.charCodeAt(c);return r.prev=7,r.next=10,D(s,{quality:"10-100",speed:"4"});case 10:l=r.sent,i=l,r.next=18;break;case 14:throw r.prev=14,r.t0=r["catch"](7),alert("Failed to run pngquant on image ".concat(n)),r.t0;case 18:return r.prev=18,t.isRecording=!1,r.finish(18);case 21:return r.next=23,e.saveFile(n,i,{base64:!0});case 23:case"end":return r.stop()}}),r,null,[[7,14,18,21]])})))()},startNewSheet:function(e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.saveImageToZip(e,"".concat(e.modelName).concat(e.sheet,".png"));case 2:n.resetSheetCanvas(e),e.sheet++;case 4:case"end":return t.stop()}}),t)})))()},resetSheetCanvas:function(e){e.row=0,e.column=0;var n=document.createElement("canvas");n.width=this.recordParams.sheetSize,n.height=this.recordParams.sheetSize,e.canvas=n,e.ctx=n.getContext("2d")},getPNGDataUrl:function(){return this.renderer.domElement.toDataURL("image/png")},onWindowResize:function(){var e=Math.min(window.innerWidth,window.innerHeight),n=e/this.recordParams.frameSize;this.renderer.domElement.style.transform="scale(".concat(n,")")},addAnimation:function(e,n,t,r){this.animationActions[e]={frames:t,action:n,animationConfig:r}},updateAngle:function(e){var n,t,r=this.angles[e]||this.angles.spritesheet;(n=this.camera.position).set.apply(n,Object(s["a"])(r.position)),(t=this.controls.target).set.apply(t,Object(s["a"])(r.target)),this.directionalLight.position.copy(this.camera.position);var a=this.config.startAngle||270,i=e;if(r.startAngle&&(i=r.startAngle),this.currentModel.rotation.set(0,C(i-a),0),this.config){var o=this.config.animations[e]||this.config[e];if(o&&o.size)this.setRenderSize(o.size);else{var c=this.config.frameSize||W;this.setRenderSize(c)}}},setRenderSize:function(e){this.lastRenderSize!=e&&(this.recordParams.frameSize=e,this.renderer.setSize(e,e),this.onWindowResize(),this.lastRenderSize=e)},loadModelFromConfig:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.config=e,this.recordParams.distance=e.distance||1.25,this.recordParams.viewAngle=void 0===e.viewAngle?60:e.viewAngle,e.sheetSize&&(this.recordParams.sheetSize=e.sheetSize),e.frameSize&&this.setRenderSize(e.frameSize);var t=[e.model,e.texture].concat(Object(s["a"])(Object.values(e.animations).map((function(e){return e.name}))));if(n){var r=n.filter((function(e){return t.includes(e.name)})),a=Object.keys(e.animations).filter((function(n){return!r.map((function(e){return e.name})).includes(e.animations[n].name)}));a.forEach((function(e){alert("Missing animation files for ".concat(e))})),this.loadModelFromFiles(r.map((function(n){var t=null;return Object.keys(e.animations).forEach((function(r){var a=e.animations[r].name;n.name===a&&(t=r)})),{blob:n,name:n.name.toLowerCase(),animationName:t}})))}else this.loadModelFromUrls(t)},loadModelFromUrls:function(e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r,a,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=[],a=0;case 2:if(!(a<e.length)){t.next=11;break}return i=e[a],t.next=6,F.a.get(i,{responseType:"blob"});case 6:o=t.sent,r.push({name:i.split("/").at(-1).toLowerCase(),blob:o.data});case 8:a++,t.next=2;break;case 11:n.loadModelFromFiles(r);case 12:case"end":return t.stop()}}),t)})))()},loadModelFromFiles:function(e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r,a,i,o,s,c,l,d,p,g,w,v,b,x,F,R,y,A,k;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.currentModel&&(n.scene.remove(n.currentModel),n.currentModel=null),n.animationActions={},n.modelReady=!1,r=new f["a"],r.addHandler(/\.tga$/i,new h["a"](r)),a=new m["a"](r),i=e.find((function(e){var n=e.name;return n.toLowerCase().includes(".fbx")&&!n.includes("@")})),o=i.blob,s=i.name,t.next=11,n.fixModelData(o);case 11:return o=t.sent,c=e.find((function(e){var n=e.name;return n.includes(".tga")})).blob,r.setURLModifier((function(n){var t=e.find((function(e){var t=e.name;return t.includes(n)}));return s.includes(n)?URL.createObjectURL(o):t?URL.createObjectURL(t.blob):n.includes(".tga")&&c?URL.createObjectURL(c):n})),l={},d={},t.next=18,G(a,s);case 18:p=n.currentModel=t.sent,p.scale.set(.01,.01,.01),n.mixer=new u["c"](p),g=(new u["e"]).setFromObject(p),n.modelDimensions={x:g.max.x-g.min.x,y:g.max.y-g.min.y,z:g.max.z-g.min.z},n.angles=M(n.modelDimensions,n.config,n.recordParams),n.updateAngle("270");while(n.anglesFolder.__controllers.length)n.anglesFolder.remove(n.anglesFolder.__controllers[0]);w={icon:function(){n.updateAngle("icon")}},v=[],b=n.config.anglesCount||H,x=0;case 30:if(!(x<b)){t.next=38;break}if(F=360/b*x,!(F>90&&F<270)){t.next=34;break}return t.abrupt("continue",35);case 34:v.push(F);case 35:x++,t.next=30;break;case 38:if(v.forEach((function(e){w[e]=function(){n.updateAngle(e)},n.anglesFolder.add(w,e)})),n.anglesFolder.add(w,"icon"),n.angleNames=v,n.scene.add(p),n.modelFolder)while(n.modelFolder.__controllers.length)n.modelFolder.remove(n.modelFolder.__controllers[0]);else n.modelFolder=n.gui.addFolder("Model");if(n.modelFolder.add(p.position,"x",-4,4).step(.1).name("Position X").listen(),n.modelFolder.add(p.position,"y",-4,4).step(.1).name("Position Y").listen(),n.modelFolder.add(p.position,"z",-4,4).step(.1).name("Position Z").listen(),n.modelFolder.add(p.rotation,"x",-4,4).step(.1).name("Rotation X").listen(),n.modelFolder.add(p.rotation,"y",-4,4).step(.1).name("Rotation Y").listen(),n.modelFolder.add(p.rotation,"z",-4,4).step(.1).name("Rotation Z").listen(),n.modelFolder.add(n.recordParams,"distance",.5,5).step(.05).name("Distance").listen().onChange((function(e){n.recordParams.distance=e,n.angles=M(n.modelDimensions,n.config,n.recordParams),n.updateAngle("270")})),n.modelFolder.add(n.recordParams,"viewAngle",0,89).step(1).name("View Angle").listen().onChange((function(e){n.recordParams.viewAngle=e,n.angles=M(n.modelDimensions,n.config,n.recordParams),n.updateAngle("270")})),n.meshPartsFolder)while(n.meshPartsFolder.__controllers.length)n.meshPartsFolder.remove(n.meshPartsFolder.__controllers[0]);else n.meshPartsFolder=n.gui.addFolder("Mesh Parts");R=n.getMeshes(p),R.sort((function(e,n){return e.name.localeCompare(n.name)})),n.config.meshesEnabled&&R.forEach((function(e){n.config.meshesEnabled.includes(e.name)||(e.visible=!1)})),R.forEach((function(e){n.meshPartsFolder.add(e,"visible").name(e.name)}));while(n.animationsFolder.__controllers.length)n.animationsFolder.remove(n.animationsFolder.__controllers[0]);while(n.actionsFolder.__controllers.length>=3)n.actionsFolder.remove(n.actionsFolder.__controllers.at(-1));y=e.filter((function(e){return e.name.includes("@")&&e.name.toLowerCase().includes(".fbx")||e.animationName})),A=regeneratorRuntime.mark((function e(t){var r,i,o,s,c,u,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=y[t],i=r.name,o=r.animationName,o||(o=i.substring(i.indexOf("@")+1,i.toLowerCase().lastIndexOf(".fbx"))),e.next=4,G(a,i);case 4:s=e.sent,c=n.mixer.clipAction(s.animations[0]),l[o]=function(){n.setAction(c)},n.animationsFolder.add(l,o),d[o]=function(){n.recordAnimationAsSheet(o)},n.actionsFolder.add(d,o),u=n.recordParams.frames,m=null,n.config.animations[o]&&(n.config.animations[o].frames&&(u=n.config.animations[o].frames),m=n.config.animations[o]),n.addAnimation(o,c,u,m);case 14:case"end":return e.stop()}}),e)})),k=0;case 61:if(!(k<y.length)){t.next=66;break}return t.delegateYield(A(k),"t0",63);case 63:k++,t.next=61;break;case 66:n.config.icon&&(d.icon=function(){n.recordAnimationAsSheet("icon")},n.actionsFolder.add(d,"icon")),n.modelReady=!0,n.animationActions.idle?n.setAction(n.animationActions.idle.action):Object.values(n.animationActions).length>0&&n.setAction(Object.values(n.animationActions)[0].action);case 69:case"end":return t.stop()}}),t)})))()},getMeshes:function(e){var n=this,t=[];return e.children.forEach((function(e){"SkinnedMesh"===e.constructor.name||"Mesh"===e.constructor.name?t.push(e):t.push.apply(t,Object(s["a"])(n.getMeshes(e)))})),t},fixModelData:function(e){return Object(c["a"])(regeneratorRuntime.mark((function n(){var t,r,a,i,o,s,c,l,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.arrayBuffer();case 2:t=n.sent,r=new Uint8Array(t),a=0,i=[".","p","s","d"].map((function(e){return e.charCodeAt(0)})),o=[".","t","g","a"].map((function(e){return e.charCodeAt(0)})),s=0;case 8:if(!(s<r.length)){n.next=22;break}c=!0,l=0;case 11:if(!(l<i.length)){n.next=18;break}if(r[s+l]===i[l]){n.next=15;break}return c=!1,n.abrupt("break",18);case 15:l++,n.next=11;break;case 18:if(c)for(a++,u=0;u<i.length;u++)r[s+u]=o[u];case 19:s++,n.next=8;break;case 22:return a>0&&console.warn("Fixed: replaced .psd with .tga ".concat(a," times")),n.abrupt("return",new Blob([t]));case 24:case"end":return n.stop()}}),n)})))()},droppedFiles:function(e){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,y(e);case 2:r=t.sent,n.loadConfigFromFiles(r),n.directoryHandle=null;case 5:case"end":return t.stop()}}),t)})))()},loadConfigFromFiles:function(e){var n=this,t=e.find((function(e){return e.name.toLowerCase().includes(".fbx")&&!e.name.includes("@")})),r=e.find((function(e){return e.name.toLowerCase().includes(".tga")}));if(t&&r){var a=e.find((function(e){return"config.json"===e.name.toLowerCase()}));if(a){var i=new FileReader;i.onload=function(t){var r=JSON.parse(t.target.result);n.loadModelFromConfig(r,e)},i.readAsText(a)}else this.loadModelFromFiles(e.map((function(e){return{blob:e,name:e.name.toLowerCase()}})))}else alert("You need to upload at least a fbx and a texture file")},openFolder:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var t,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,window.showDirectoryPicker({mode:"readwrite",writable:!0});case 2:return t=n.sent,n.next=5,t.requestPermission({mode:"readwrite"});case 5:return r=[],n.next=8,e.addFilesFromFolder(t,r);case 8:e.loadConfigFromFiles(r),e.directoryHandle=t;case 10:case"end":return n.stop()}}),n)})))()},addFilesFromFolder:function(e,n){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,u,d,m,f,h;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=!1,i=!1,r.prev=2,c=Object(l["a"])(e.entries());case 4:return r.next=6,c.next();case 6:if(!(a=!(u=r.sent).done)){r.next=22;break}if(d=Object(o["a"])(u.value,2),m=d[0],f=d[1],m=m.toLowerCase(),!(f instanceof window.FileSystemDirectoryHandle)){r.next=14;break}return r.next=12,t.addFilesFromFolder(f,n);case 12:r.next=19;break;case 14:if("config.json"!==m&&!m.includes("fbx")&&!m.includes("tga")){r.next=19;break}return r.next=17,f.getFile();case 17:h=r.sent,n.push(h);case 19:a=!1,r.next=4;break;case 22:r.next=28;break;case 24:r.prev=24,r.t0=r["catch"](2),i=!0,s=r.t0;case 28:if(r.prev=28,r.prev=29,!a||null==c.return){r.next=33;break}return r.next=33,c.return();case 33:if(r.prev=33,!i){r.next=36;break}throw s;case 36:return r.finish(33);case 37:return r.finish(28);case 38:case"end":return r.stop()}}),r,null,[[2,24,28,38],[29,,33,37]])})))()}},mounted:function(){var e=this,n=this.scene=new u["O"],t=new u["a"](16777215,.3);t.name="ambient_light",n.add(t);var r=new u["l"](16777215,.8*Math.PI);r.name="main_light",n.add(r),this.directionalLight=r;var a=new u["s"];a.name="hemi_light",n.add(a);var i=this.camera=new u["I"](75,1,.01,1e3),o=this.renderer=new u["bb"]({preserveDrawingBuffer:!0,alpha:!0});o.setSize(this.recordParams.frameSize,this.recordParams.frameSize),o.gammaOutput=!0,this.$el.appendChild(o.domElement);var s=this.controls=new d["a"](i,o.domElement);s.enableDamping=!0,s.target.set(0,0,0),this.loadModelFromConfig(R),window.addEventListener("resize",this.onWindowResize,!1),this.onWindowResize();var c=Object(p["a"])(),l=this.gui=new g["a"];this.animationsFolder=l.addFolder("Animations");var m=l.addFolder("Camera");m.add(i.position,"x",-4,4).name("Position x").step(.01).listen(),m.add(i.position,"y",-4,4).name("Position y").step(.01).listen(),m.add(i.position,"z",-4,4).name("Position z").step(.01).listen(),m.add(i.rotation,"x",-4,4).name("Rotation x").step(.01).listen(),m.add(i.rotation,"y",-4,4).name("Rotation y").step(.01).listen(),m.add(i.rotation,"z",-4,4).name("Rotation z").step(.01).listen(),m.add(s.target,"x",-4,4).name("Target x").step(.01).listen(),m.add(s.target,"y",-4,4).name("Target y").step(.01).listen(),m.add(s.target,"z",-4,4).name("Target z").step(.01).listen(),this.anglesFolder=l.addFolder("Angles"),this.actionsFolder=l.addFolder("Actions"),this.actionsFolder.add({"Save As Sheets":function(){e.recordAllAsSheets(e.config.name)}},"Save As Sheets"),this.actionsFolder.add({"Open Folder":function(){e.openFolder()}},"Open Folder"),this.actionsFolder.open(),this.frameSettingsFolder=this.gui.addFolder("Frames"),this.frameSettingsFolder.add(this.recordParams,"frames",1,20).step(1).name("Frames").listen(),this.frameSettingsFolder.add(this.recordParams,"frameSize",32,1024).step(32).name("Frame Size").listen().onChange((function(n){o.setSize(n,n),e.onWindowResize()})),this.frameSettingsFolder.add(this.recordParams,"sheetSize",64,16384).step(64).name("Sheet Size").listen(),this.frameSettingsFolder.add(this.recordParams,"compressPNG").name("Compress PNG").listen();var f=l.addFolder("Lights");f.add(t,"intensity",0,5).name("Ambient Light").step(.01).listen(),f.add(r,"intensity",0,5).name("Directional Light").step(.01).listen(),f.add(a,"intensity",0,5).name("Hemisphere Light").step(.01).listen();var h=new u["h"],w=function n(){requestAnimationFrame(n),s.update(),e.modelReady&&!e.isRecording&&e.mixer.update(h.getDelta()),v(),c.update()};function v(){o.render(n,i)}w()},destroyed:function(){this.gui.destroy()}};function I(){return new Promise((function(e){requestAnimationFrame((function(){e()}))}))}function G(e,n){return new Promise((function(t,r){e.load(n,(function(e){t(e)}),(function(e){}),(function(e){console.error(e),r(e)}))}))}var X=B,q=(t("034f"),t("2877")),K=Object(q["a"])(X,a,i,!1,null,null,null),Z=K.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(Z)}}).$mount("#app")},"85ec":function(e,n,t){},a2d6:function(e){e.exports=JSON.parse('{"name":"Demo","model":"models/ToonRTS_demo_Knight/model.FBX","texture":"models/ToonRTS_demo_Knight/DemoTexture.tga","animations":{"idle":{"name":"models/ToonRTS_demo_Knight/model@idle.FBX","frames":4},"walk":{"name":"models/ToonRTS_demo_Knight/model@run.FBX","frames":12},"run":{"name":"models/ToonRTS_demo_Knight/model@run.FBX","frames":12},"attack":{"name":"models/ToonRTS_demo_Knight/model@attack.FBX","frames":12,"skipEnd":0.4}},"icon":{"animation":"idle","size":512},"viewAngle":60}')}});
//# sourceMappingURL=app.7c5de4b4.js.map